<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Registrar Disciplinas</title>
    <!-- Adicionando o link do FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Fonte Montserrat */
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&display=swap');

        body {
            font-family: 'Montserrat', sans-serif;
            background: #f1f0ea;
            padding: 20px;
        }

        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background-color: #f1f0ea;
            display: flex;
            align-items: center;
            padding: 0 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.025);
            z-index: 10;
        }
    
        #header {
            font-size: 22px;
            color: #542aa3;
            padding-top: 15px;
            padding-left: 10px;
        }
    
        #headerInside {
            font-size: 22px;
            color: #542aa3;
            margin-top: 10px;
            margin-bottom: 50px;
        }
    
        .sidebar {
              display: flex;
              flex-direction: column; /* Organiza os itens verticalmente */
              height: 100vh; /* Faz a sidebar ocupar toda a altura da tela */
              position: fixed;
              top: 0;
              left: -290px; /* Oculta a sidebar inicialmente */
              width: 250px;
              height: 100%;
              background-color: #f1f0ea;
              color: #474c5f;
              transition: left 0.3s ease;
              padding: 1rem;
              padding-top: 0px;
              z-index: 12;
        }
    
        .top-bar {
            display: flex;
            align-items: center; /* Alinha o botão e o h1 horizontalmente no centro verticalmente */
            margin-bottom: 10px; /* Espaço entre a barra superior e o conteúdo abaixo */
        }
    
        /* Classe para mostrar a sidebar */
        .sidebar.active {
            left: 0;
        }

        /* Sidebar aberta */
        #toggleSidebar.active {
            color: black;
            transition: all 1s ease;
        }
    
        .sidebarBtn {
            background: none;
            color: #474c5f;
            font-weight: bold;
            font-size: 18px;
            margin-top: 0px;
            gap: 10px;
            display: flex;
        }
    
        .sidebarButtons {
            margin-top: 20px;
        }
    
        /* Estuda.ai */
        #header.active {
            color: black;
            transition: all 1s ease;
        }

        /* Estilos do Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);  /* Cor do fundo do overlay */
            z-index: 11;  /* Coloca o overlay acima de outros elementos */
            opacity: 0;
            pointer-events: none;  /* Não interage com o mouse até ser visível */
            transition: opacity 0.3s ease-in-out;  /* Suaviza a transição */
        }
        
        .overlay.active {
            opacity: 1;
            pointer-events: auto;  /* Permite interação com o overlay quando visível */
        }

        .primeiro-bloco {
            padding-top: 25px;
        }
    
        section {
            margin-bottom: 2rem;
            border-radius: 8px;
        }
    
        /* Botão de menu dentro do cabeçalho */
        #toggleSidebar {
            background: none;
            border: none;
            font-size: 1.8rem;
            color: #6735bc;
            cursor: pointer;
            z-index: 15;
        }
    
        #toggleSidebarInside {
            background: none;
            border: none;
            font-size: 1.8rem;
            color: #6735bc;
            cursor: pointer;
            z-index: 15;
        }
        
        h1 {
            padding-top: 0px;
            padding-bottom: 5px;
            text-align: center;
            color: #474c5f;
         
        }
    
        h2 {
            font-weight: bold;
            padding-top: 30px;
            color: #474c5f;
        }

        input {
            padding: 10px;
            font-size: 16px;
            margin-top: 0px;
            border-radius: 6px;
            border: 1px solid #ccc;
        }

        button {
            font-family: 'Montserrat';
            background-color: #474c5f;
            color: white;
            cursor: pointer;
            padding: 7px;
            
            border: none;
            border-radius: 4px;
            margin-top: 10px;
            margin-right: 5px;
        }

        button:hover {
            background-color: #542aa3;
        }

        ul {
            margin-top: 20px;
            padding-left: 20px;
        }

        li {
            margin-bottom: 12px;
        }

        .topicos {
            margin-top: 5px;
            padding-left: 15px;
            color: #333;
        }

        .disciplina-bloco {
            border: 1px solid rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            margin-bottom: 10px;
            padding: 10px;
            padding-top: 0px;
            cursor: pointer;
            background: #f9f9f9;
        }

        .disciplina-bloco.minimizado .topicos {
            display: none;
        }

        .disciplina-bloco.maximizado .topicos {
            display: block;
        }

        .confirmar-cancelar {
            display: none;
        }

        .confirmar-cancelar.show {
            display: block;
        }

        .botao-adicionar-excluir.hide {
            display: none;
        }

        .lixeira {
            display: none;
            cursor: pointer;
            margin-left: 10px;
            color: red;
        }

        .topico-lixeira.show, .disciplina-lixeira.show {
            display: inline;
        }

        /* Estilo para o ícone de + com rotação suave */
        .rotate {
            transition: transform 0.6s ease-in-out;
        }

        .rotate.open {
            transform: rotate(135deg);
        }
    
        .btn-excluir {
            background: none;
            color: red;
        }
    
        .btn-minimizar {
            color: #474c5f;
            background: none;
        }
    
        #caixa-disciplinas {
            padding-top: 0px;            
        }
    
    </style>
</head>
<body>
    <header>
        <!-- Botão para abrir/fechar sidebar -->
        <button id="toggleSidebar"><i class="fas fa-bars"></i></button>
        <h1 id="header">Estuda.ai</h1>
    </header>
    
    <!-- Sidebar -->
    <div id="sidebar" class="sidebar">
        
        <div class="top-bar">
            <!-- Botão para abrir/fechar sidebar -->
            <button id="toggleSidebarInside"><i class="fas fa-bars"></i></button>
            <h1 id="header">Estuda.ai</h1>
        </div>
        
        <div class="sidebarButtons">
            <button onclick="window.location.href='index.html'" class="sidebarBtn"><i class="fa-solid fa-house"></i> Inicio</button>
            <button onclick="window.location.href='disciplinas.html'" class="sidebarBtn" ><i class="fa-regular fa-pen-to-square"></i> Disciplinas</button>
            <button onclick="window.location.href='cronograma.html'" class="sidebarBtn" ><i class="fa-regular fa-calendar"></i> Cronograma</button>
        </div>

    </div>
    
    <!-- Overlay -->
    <div id="overlay" class="overlay"></div>
      
    <section class="primeiro-bloco">
        <h2>Registrar Disciplinas</h2>
        <input type="text" id="nomeDisciplina" placeholder="Nome da disciplina">
        <button onclick="adicionarDisciplina()">Adicionar Disciplina</button>
    </section>
    
    <section id="caixa-disciplinas" >
       <h2 class="subtitulo"><i class="fa-solid fa-list-check"></i> Minhas disciplinas</h2>
       <div class="disciplinas-container" id="disciplinasContainer"></div>
    </section>
    
    <script>
        // Sidebar
        const sidebar = document.getElementById('sidebar');          // Sidebar
        const toggleBtn = document.getElementById('toggleSidebar');  // Botão no cabeçalho
        const toggleBtnInside = document.getElementById('toggleSidebarInside');  // Botão dentro da sidebar
        const toggleHeader = document.getElementById('header');  // Estuda.ai
        const overlay = document.getElementById('overlay');  // Overlay
    
        // Alternar a sidebar e aplicar classe ativa ao botão
        toggleBtn.addEventListener('click', (e) => {
            e.stopPropagation(); // Evita fechar ao clicar no botão
            sidebar.classList.toggle('active');  // Abre/fecha a sidebar
            toggleBtn.classList.toggle('active'); // Altera a aparência do botão
            toggleHeader.classList.toggle('active'); // Altera a aparência do cabeçalho
        
            // Alterna a visibilidade do overlay
            if (sidebar.classList.contains('active')) {
                overlay.classList.add('active');  // Exibe o overlay quando a sidebar estiver aberta
            } else {
                overlay.classList.remove('active');  // Esconde o overlay quando a sidebar estiver fechada
            }
        });
    
        // Alternar a sidebar e aplicar classe ativa ao botão dentro da sidebar
        toggleBtnInside.addEventListener('click', (e) => {
            e.stopPropagation(); // Evita fechar ao clicar no botão
            sidebar.classList.toggle('active');  // Abre/fecha a sidebar
            toggleBtn.classList.toggle('active'); // Altera a aparência do botão
            toggleHeader.classList.toggle('active'); // Altera a aparência do cabeçalho
        
            // Alterna a visibilidade do overlay
            if (sidebar.classList.contains('active')) {
                overlay.classList.add('active');  // Exibe o overlay quando a sidebar estiver aberta
            } else {
                overlay.classList.remove('active');  // Esconde o overlay quando a sidebar estiver fechada
            }
        });
        
        // Fechar a sidebar ao clicar no overlay
        overlay.addEventListener('click', () => {
            sidebar.classList.remove('active');
            toggleBtn.classList.remove('active');
            toggleHeader.classList.remove('active');
            overlay.classList.remove('active');
        });

        let disciplinas = JSON.parse(localStorage.getItem('disciplinas')) || [];

        // Função para remover acentuação
        function removerAcentuacao(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
        }

        // Função para adicionar uma nova disciplina
        function adicionarDisciplina() {
            const nomeInput = document.getElementById('nomeDisciplina');
            const nome = nomeInput.value.trim();
            if (nome === "") return;

            // Remover acentuação para comparação
            const nomeSemAcento = removerAcentuacao(nome).toLowerCase();
            
            const nomeExiste = disciplinas.some(d => removerAcentuacao(d.nome).toLowerCase() === nomeSemAcento);
            if (nomeExiste) {
                alert("Essa disciplina já está registrada.");
                nomeInput.value = "";
                return;
            }

            disciplinas.push({ nome: nome, topicos: [], maximizado: false, excluirAtivo: false });
            localStorage.setItem('disciplinas', JSON.stringify(disciplinas));
            nomeInput.value = "";
            exibirDisciplinas();
        }

        // Função para alternar entre mostrar/ocultar os tópicos e rotacionar o ícone
        function alternarVisibilidade(index) {
            const disciplina = disciplinas[index];
            disciplina.maximizado = !disciplina.maximizado;
            localStorage.setItem('disciplinas', JSON.stringify(disciplinas));
            exibirDisciplinas();

            // Alterando a rotação do ícone
            const icone = document.getElementById('icone-' + index);
            if (disciplina.maximizado) {
                icone.classList.add('open');
            } else {
                icone.classList.remove('open');
            }
        }

        // Função para adicionar um novo tópico à disciplina
        function adicionarTopico(index) {
            const topico = prompt("Digite o tópico:");
            if (topico) {
                disciplinas[index].topicos.push(topico);
                localStorage.setItem('disciplinas', JSON.stringify(disciplinas));
                exibirDisciplinas();
            }
        }

        // Função para ativar o modo de exclusão
        function ativarExclusao(index) {
            disciplinas[index].excluirAtivo = true;
            localStorage.setItem('disciplinas', JSON.stringify(disciplinas));
            exibirDisciplinas();
        }

        // Função para cancelar a exclusão
        function cancelarExclusao(index) {
            disciplinas[index].excluirAtivo = false;
            localStorage.setItem('disciplinas', JSON.stringify(disciplinas));
            exibirDisciplinas();
        }

        // Função para confirmar a exclusão dos tópicos ou da disciplina
        function confirmarExclusao(indexDisciplina, indexTopico) {
            if (indexTopico !== undefined) {
                // Excluir tópico específico
                disciplinas[indexDisciplina].topicos.splice(indexTopico, 1);
            } else {
                // Excluir a disciplina inteira
                disciplinas.splice(indexDisciplina, 1);
            }
            localStorage.setItem('disciplinas', JSON.stringify(disciplinas));
            exibirDisciplinas();
        }

        // Função para confirmar exclusão com prompt
        function confirmarComPrompt(indexDisciplina, indexTopico) {
            const confirmacao = confirm("Tem certeza de que deseja excluir?");
            if (confirmacao) {
                confirmarExclusao(indexDisciplina, indexTopico);
            }
        }

        // Função para exibir todas as disciplinas
        function exibirDisciplinas() {
            const container = document.getElementById('disciplinasContainer');
            container.innerHTML = "";
            
            if (disciplinas.length === 0) {
                container.innerHTML = "<p>Nenhuma disciplina registrada.</p>";
                return;
            }

            disciplinas.forEach((disciplina, index) => {
                const bloco = document.createElement('div');
                bloco.className = `disciplina-bloco ${disciplina.maximizado ? 'maximizado' : 'minimizado'}`;

                bloco.innerHTML = `
                    <strong>${disciplina.nome}</strong>
                    <button class="btn-minimizar" onclick="alternarVisibilidade(${index})">
                        <i id="icone-${index}" class="fas fa-plus rotate"></i>
                    </button>
                    <div class="topicos">
                        ${disciplina.topicos.map((topico, topicoIndex) => `
                            <p>
                                ${topico}
                                <span class="lixeira topico-lixeira ${disciplina.excluirAtivo ? 'show' : ''}" onclick="confirmarComPrompt(${index}, ${topicoIndex})">
                                    <i class="fas fa-trash-alt"></i>
                                </span>
                            </p>
                        `).join('')}
                    </div>
                    
                    ${disciplina.maximizado ? `
                        <div class="botao-adicionar-excluir ${disciplina.excluirAtivo ? 'hide' : ''}">
                            <button class="btn-add" onclick="adicionarTopico(${index})"><i class="fas fa-plus"></i> Adicionar Tópico</button>
                            <button class="btn-excluir" onclick="ativarExclusao(${index})"><i class="fas fa-trash"></i></button>
                        </div>
                        <div class="confirmar-cancelar ${disciplina.excluirAtivo ? 'show' : ''}">
                            <button class="btn-excluir" onclick="cancelarExclusao(${index})"><i class="fas fa-times"></i> Cancelar</button>
                            <button class="btn-excluir" onclick="confirmarExclusao(${index})"><i class="fas fa-trash"></i> Excluir Disciplina</button>
                        </div>
                    ` : ''}
                `;

                container.appendChild(bloco);
            });
        }

        // Exibir disciplinas ao carregar a página
        exibirDisciplinas();
    </script>
</body>
</html>
